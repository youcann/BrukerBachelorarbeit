\chapter{Material und Methoden}

\section{MRiLab}

MRiLab wird auf einem PC mit einer High-End Consumer Grafikkarte installiert (siehe \autoref{sec:usedPC}). 

\subsection{Analyse Bildrekonstruktionsalgorithmus}

\section{Bestimmung notwendiger Simulationsparameter}

\subsection{Berechnung Empfängerbandbreite}

Die Lamorfrequenzen an den Rändern des Probenraums sind:
\begin{subequations}
	\begin{align}
	f_{min}=\frac{\gamma}{2\pi} (B_0+G x_{min}) \\
	f_{max}=\frac{\gamma}{2\pi} (B_0+G x_{max})
	\end{align}
\end{subequations}
mit:
\begin{with}
	\frac{\gamma}{2\pi} =\SI{42.577478}{\mega\hertz\per\tesla}& Gyromagnetisches Verhältnis für \ce{^{1}H}-Kerne \\
	B_0 \text{~(in \SI{}{\tesla})} & Feldstärke statisches Magnetfeld \\
	G \text{~(in \SI{}{\tesla\per\meter})} & Gradientenstärke \\
\end{with}

Die notwendige Empfängerbandbreite $\Delta f$ ergibt sich daraus zu:
\begin{equation}
\Delta f = f_{max}-f_{min} = \frac{\gamma}{2\pi} G (x_{max}-x_{min})
\end{equation}
Da die Länge $x_{max}-x_{min}$ der Größe des $FOV$ in der betrachteten Richtung entspricht, kann $\Delta f$ berechnet werden mit:
\begin{equation}
\label{eq:deltaF}
\Delta f(G, FOV) = G \cdot FOV
\end{equation}

Mit Hilfe von \autoref{eq:deltaF} und typischen Werten für die Gradientenstärke und das FOV werden einige Empfängerbandbreiten berechnet (\autoref{tab:empfBandbreite}).

\begin{table}[H]
	\centering
	\caption{Notwendige Empfängerbandbreiten in Abhängigkeit des Field of View (FOV) und der Gradientenstärke}
	\label{tab:empfBandbreite}
	\begin{tabular}{llll}
		\toprule
		& \multicolumn{3}{c}{\textbf{G (in \SI{}{\milli\tesla\per\meter})}} \\ \cmidrule{2-4}
		\textbf{FOV (in \SI{}{\mm})}& 200 & 500 & 1000 \\
		20 & \SI{0.170}{\mega\hertz} & \SI{0.425}{\mega\hertz} & \SI{0.851}{\mega\hertz} \\
		50 & \SI{0.426}{\mega\hertz} & \SI{1.06}{\mega\hertz} & \SI{2.13}{\mega\hertz} \\
		150 & \SI{1.277}{\mega\hertz} & \SI{3.19}{\mega\hertz} & \SI{6.39}{\mega\hertz} \\
		\bottomrule
	\end{tabular}
\end{table}

\section{Generierung von farbigem Phasenrauschen}

\subsection{Grundsätzliche Vorgehensweise}


\begin{figure}[H]
	\centering
	\resizebox{14cm}{!}{\includegraphics[]{img/rauschSimu.tikz}}
	\caption[Simulation]{Simu}
	\label{fig:aaa}
\end{figure}


\subsection{Interpolation im Frequenzbereich}

\subsection{FIR/IIR Filter}

\paragraph{Vorbemerkung:}\mbox{}\\
MATLAB verwendet in den Filterdesign-Tools der "Signal Processing Toolbox" normierte Frequenzen:
\begin{subequations}
	\begin{align}
	f_{norm} = \text{"normalized frequency"} &= \frac{2f}{f_S} \\
	\omega_{norm} = \text{"radian frequency"} &= \frac{2\pi f}{f_S}
	\end{align}
\end{subequations}
Für Frequenzen im sinnvollen Bereich $f\in [0,f_S/2]$ ergibt sich damit der Wertebereich von
$f_{norm}$ und $\omega_{norm}/\pi$ zu $\mathbb{W}_{f_{norm}}=\mathbb{W}_{\omega_{norm}/\pi}=[0,1]$.

Übliche (digitale) Filter, wie Tiefpässe, Hochpässe und Bandpässe/Bandsperren haben in der Regel einfach zu formulierende Designziele: Ein steiler Übergang von den Passbändern zu den Stoppbändern und eine jeweils kleine Welligkeit in den Bändern.
Für das Design solcher Filter bietet die \textit{Signal Processing Toolbox} in MATLAB einige Werkzeuge, wie z.B. den \textit{FilterDesigner} an.

Filter mit beliebigem Amplituden- bzw. Phasengang können damit nicht entworfen werden. Stattdessen eignet sich beispielsweise die Funktion \texttt{fir2()}, um die Filterkoeffizienten für einen FIR-Filter mit beliebigem Amplitudengang zu ermitteln\footnote{\texttt{cfirpm()} und \texttt{firpm()} sind weitere Möglichkeiten, einen FIR-Filter mit der "equiripple"- bzw. "Parks-McClellan"-Methode zu erzeugen.}. Ein IIR-Filter kann mit Hilfe der modifizierten Yule-Walker-Gleichungen und eines Least-Square-Fits durch die Funktion \texttt{yulewalk()} generiert werden.


\begin{figure}[H]
	\centering
	\subcaptionbox{FIR-Filter, Ordnung $n=1000$}{\includegraphics[width=0.45\textwidth,height=0.5\textwidth]{plots/fir.tikz}}
	\hfill
	\subcaptionbox{IIR-Filter, Ordnung $n=70$}{\includegraphics[width=0.45\textwidth,height=0.5\textwidth]{plots/iir.tikz}}
	\caption{Caption}
\end{figure}




\section{Phasenrauschfunktion für MRiLab}

\section{Erstellung MRT Phantom}
